# 1. 需求
根据芯片厂商提供的APN参数Excel表格，将其转化为对应的xml形式文件。  
主要的转换难点在于参数非常多，共计2w余项，采用人工从0对比生成的话基本不可能，所以需要自动化脚本进行处理。  

# 2. 脚本执行过程

## 2.1 前期准备
此处的操作主要是将源Excel表格进行切分和转换，使其能够被脚本正确处理。  
APN参数Excel表格中，以**黄色填充行**为分割线，可总共分为5类，我们要做的就是**将每类分别复制到一个单独的excel表格中**（同一个文件的不同sheet）处理，复制为直接按行复制。  

其中每一类的**范围**为从NAME...user_editable/user_visible，再加上user_editable和user_visible两行，务必按照这个顺序复制。

第一类参数需要注意有 **mvno_type** 和 **mvno_match_data** 两行需要额外复制进去。

每个Sheet第一行务必保证为**NAME**行，否则生成的xml会有格式问题。

具体请参考提供的已有excel示例文件。
## 2.2 执行
将脚本代码中的**输入输出文件路径**修改为需要的路径，直接运行即可。  

# 3. 注意点
## 3.1 对比源excel表格中第一列
对比源excel表格第一列的值，是否和脚本中**column_map**对应，如果存在没有的字符串（非全小写形式），需要修改代码中的column_map，否则生成的xml文件可能无法被正确解析，导致系统phone频繁报错。
## 3.2 脚本执行过程中打印内容
转换完成后，注意留意打印内容，打印内容为经过特别处理（去除、替换等）的字符串，需查看是否有错误处理的部分。

## 3.3 检查生成的xml文件
1）检查**authtype**的值是否存在非数字值  
2）对比服务器代码中原有的apns-conf.xml文件，查看差异处，对比excel表格确定

## 3.4 xml文件生成为追加形式
脚本生成的xml文件为追加形式，请确保输出的xml文件中事先不存在内容。