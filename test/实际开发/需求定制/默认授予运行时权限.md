# 目标
直接授予apk运行时权限，使得apk不用通过弹窗用户确认授予权限。  

# 实现
DefaultPermissionGrantPolicy.java中，包含了所有可授予的运行时权限静态常量，可直接使用。

```diff
diff --git a/frameworks/base/services/core/java/com/android/server/pm/permission/DefaultPermissionGrantPolicy.java b/frameworks/base/services/core/java/com/android/server/pm/permission/DefaultPermissionGrantPolicy.java
index 25c261bcb0c..2f0a256d7f1 100644
--- a/frameworks/base/services/core/java/com/android/server/pm/permission/DefaultPermissionGrantPolicy.java
+++ b/frameworks/base/services/core/java/com/android/server/pm/permission/DefaultPermissionGrantPolicy.java
@@ -394,10 +394,22 @@ public final class DefaultPermissionGrantPolicy {
         grantSignatureAppsNotificationPermissions(pm, userId);
         grantDefaultPermissionExceptions(pm, userId);

+        PackageInfo pkg = pm.getPackageInfo("com.irest.pad_app");
+        if ((pkg != null) && doesPackageSupportRuntimePermissions(pkg)) {
+            setIrestPackagePermissions(pm, pkg, userId);
+        }
+
         // Apply delayed state
         pm.apply();
     }

+    public void setIrestPackagePermissions(PackageManagerWrapper pm, PackageInfo pkg, int userId) {
+        Log.d(TAG + "By Zebra", "setIrestPackagePermissions is start");
+        grantRuntimePermissions(pm, pkg, STORAGE_PERMISSIONS, true, true, true, userId);
+        grantRuntimePermissions(pm, pkg, ALWAYS_LOCATION_PERMISSIONS, true, true, true, userId);
+        grantRuntimePermissions(pm, pkg, CAMERA_PERMISSIONS, true, true, true, userId);
+    }
+
     private void grantSignatureAppsNotificationPermissions(PackageManagerWrapper pm, int userId) {
         Log.i(TAG, "Granting Notification permissions to platform signature apps for user "
                 + userId);
```
# 相关资料
[Android 屏蔽锁屏界面上特定的通知显示](https://blog.csdn.net/u012514113/article/details/130186104)
